clear all
close all
clc

sim=remApi('remoteApi'); % using the prototype file (remoteApiProto.m)
sim.simxFinish(-1); % just in case, close all opened connections
clientID=sim.simxStart('127.0.0.1',19999,true,true,5000,5);
    
if (clientID>-1)   
 disp('Connected to remote API server');

 
Rest_Position = [0,-2.61799387799149,0.785398163397448,0,0.523598775598299,0.785398163397448,0,3.66519142918809,0.785398163397448,0,-2.61799387799149,0.785398163397448,0,-2.61799387799149,0.785398163397448,0,0.523598775598299,0.785398163397448,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
Right_Step_Up = [0,-2.96705972839036,1.5707963267949,0,0.523598775598299,0.785398163397448,0,3.31612557878923,1.5707963267949,0,-2.61799387799149,0.785398163397448,0,-2.96705972839036,1.5707963267949,0,0.523598775598299,0.785398163397448,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
 
Right_Twisted = [0.174532925199433,-2.96705972839036,1.5707963267949,0,0.523598775598299,0.785398163397448,0.349065850398866,3.31612557878923,1.5707963267949,0,-2.61799387799149,0.785398163397448,-0.523598775598299,-2.96705972839036,1.5707963267949,0,0.523598775598299,0.785398163397448,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
Right_Step_Down = [0.174532925199433,-2.96705972839036,0.785398163397448,0,0.523598775598299,0.785398163397448,0.349065850398866,3.31612557878923,0.785398163397448,0,-2.61799387799149,0.785398163397448,-0.523598775598299,-2.96705972839036,0.785398163397448,0,0.523598775598299,0.785398163397448,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
Right_Foot_Down = [0.174532925199433,-2.61799387799149,0.785398163397448,0,0.523598775598299,0.785398163397448,0.349065850398866,3.66519142918809,0.785398163397448,0,-2.61799387799149,0.785398163397448,-0.523598775598299,-2.61799387799149,0.785398163397448,0,0.523598775598299,0.785398163397448,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
Left_Step_Up = [0.174532925199433,-2.61799387799149,0.785398163397448,0,0.174532925199433,1.5707963267949,0.349065850398866,3.66519142918809,0.785398163397448,0,-2.96705972839036,1.5707963267949,-0.523598775598299,-2.61799387799149,0.785398163397448,0,0.174532925199433,1.5707963267949,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
Right_Untwisted = [0,-2.61799387799149,0.785398163397448,0,0.174532925199433,1.5707963267949,0,3.66519142918809,0.785398163397448,0,-2.96705972839036,1.5707963267949,0,-2.61799387799149,0.785398163397448,0,0.174532925199433,1.5707963267949,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
Left_Twisted = [0,-2.61799387799149,0.785398163397448,0.523598775598299,0.174532925199433,1.5707963267949,0,3.66519142918809,0.785398163397448,-0.174532925199433,-2.96705972839036,1.5707963267949,0,-2.61799387799149,0.785398163397448,-0.349065850398866,0.174532925199433,1.5707963267949,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
Left_Step_Down = [0,-2.61799387799149,0.785398163397448,0.523598775598299,0.174532925199433,0.785398163397448,0,3.66519142918809,0.785398163397448,-0.174532925199433,-2.96705972839036,0.785398163397448,0,-2.61799387799149,0.785398163397448,-0.349065850398866,0.174532925199433,0.785398163397448,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
Left_Foot_Down = [0,-2.61799387799149,0.785398163397448,0.523598775598299,0.523598775598299,0.785398163397448,0,3.66519142918809,0.785398163397448,-0.174532925199433,-2.61799387799149,0.785398163397448,0,-2.61799387799149,0.785398163397448,-0.349065850398866,0.523598775598299,0.785398163397448,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
Right_Step_Up_2 = [0,-2.96705972839036,1.5707963267949,0.523598775598299,0.523598775598299,0.785398163397448,0,3.31612557878923,1.5707963267949,-0.174532925199433,-2.61799387799149,0.785398163397448,0,-2.96705972839036,1.5707963267949,-0.349065850398866,0.523598775598299,0.785398163397448,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
Left_Untwisted = [0,-2.96705972839036,1.5707963267949,0,0.523598775598299,0.785398163397448,0,3.31612557878923,1.5707963267949,0,-2.61799387799149,0.785398163397448,0,-2.96705972839036,1.5707963267949,0,0.523598775598299,0.785398163397448,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
Right_Foot_Down_2 = [0,-2.96705972839036,0.785398163397448,0,0.523598775598299,0.785398163397448,0,3.31612557878923,0.785398163397448,0,-2.61799387799149,0.785398163397448,0,-2.96705972839036,0.785398163397448,0,0.523598775598299,0.785398163397448,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];

Tail_Leftt = [0,-2.61799387799149,0.785398163397448,0,0.523598775598299,0.785398163397448,0,3.66519142918809,0.785398163397448,0,-2.61799387799149,0.785398163397448,0,-2.61799387799149,0.785398163397448,0,0.523598775598299,0.785398163397448,0.523598775598299,-0.523598775598299,-1.22173047639603,-1.22173047639603,-0.436332312998582];
Tail_Rightt = [0,-2.61799387799149,0.785398163397448,0,0.523598775598299,0.785398163397448,0,3.66519142918809,0.785398163397448,0,-2.61799387799149,0.785398163397448,0,-2.61799387799149,0.785398163397448,0,0.523598775598299,0.785398163397448,-0.523598775598299,-0.523598775598299,-1.22173047639603,-1.22173047639603,-0.436332312998582];

L_Right_Turn = [0.349065850398866,-2.96705972839036,1.5707963267949,0,0.523598775598299,0.785398163397448,0.349065850398866,3.31612557878923,1.5707963267949,0,-2.61799387799149,0.785398163397448,0.523598775598299,-2.96705972839036,1.5707963267949,0,0.523598775598299,0.785398163397448,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
L_Right_Step_Down = [0.349065850398866,-2.96705972839036,0.785398163397448,0,0.523598775598299,0.785398163397448,0.349065850398866,3.31612557878923,0.785398163397448,0,-2.61799387799149,0.785398163397448,0.523598775598299,-2.96705972839036,0.785398163397448,0,0.523598775598299,0.785398163397448,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
L_Right_Foot_Down = [0.349065850398866,-2.61799387799149,0.785398163397448,0,0.523598775598299,0.785398163397448,0.349065850398866,3.66519142918809,0.785398163397448,0,-2.61799387799149,0.785398163397448,0.523598775598299,-2.61799387799149,0.785398163397448,0,0.523598775598299,0.785398163397448,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
L_Left_Step_Up = [0.349065850398866,-2.61799387799149,0.785398163397448,0,0.174532925199433,1.5707963267949,0.349065850398866,3.66519142918809,0.785398163397448,0,-2.96705972839036,1.5707963267949,0.523598775598299,-2.61799387799149,0.785398163397448,0,0.174532925199433,1.5707963267949,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
L_Right_Unturn = [0,-2.61799387799149,0.785398163397448,0,0.174532925199433,1.5707963267949,0,3.66519142918809,0.785398163397448,0,-2.96705972839036,1.5707963267949,0,-2.61799387799149,0.785398163397448,0,0.174532925199433,1.5707963267949,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
L_Left_Turn = [0,-2.61799387799149,0.785398163397448,0.523598775598299,0.174532925199433,1.5707963267949,0,3.66519142918809,0.785398163397448,0.349065850398866,-2.96705972839036,1.5707963267949,0,-2.61799387799149,0.785398163397448,0.349065850398866,0.174532925199433,1.5707963267949,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
L_Left_Step_Down = [0,-2.61799387799149,0.785398163397448,0.523598775598299,0.174532925199433,0.785398163397448,0,3.66519142918809,0.785398163397448,0.349065850398866,-2.96705972839036,0.785398163397448,0,-2.61799387799149,0.785398163397448,0.349065850398866,0.174532925199433,0.785398163397448,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
L_Left_Foot_Down = [0,-2.61799387799149,0.785398163397448,0.523598775598299,0.523598775598299,0.785398163397448,0,3.66519142918809,0.785398163397448,0.349065850398866,-2.61799387799149,0.785398163397448,0,-2.61799387799149,0.785398163397448,0.349065850398866,0.523598775598299,0.785398163397448,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
L_Right_Step_Up_2 = [0,-2.96705972839036,1.5707963267949,0.523598775598299,0.523598775598299,0.785398163397448,0,3.31612557878923,1.5707963267949,0.349065850398866,-2.61799387799149,0.785398163397448,0,-2.96705972839036,1.5707963267949,0.349065850398866,0.523598775598299,0.785398163397448,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
L_Left_Unturn = [0,-2.96705972839036,1.5707963267949,0,0.523598775598299,0.785398163397448,0,3.31612557878923,1.5707963267949,0,-2.61799387799149,0.785398163397448,0,-2.96705972839036,1.5707963267949,0,0.523598775598299,0.785398163397448,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
L_Right_Foot_Down_2 = [0,-2.96705972839036,0.785398163397448,0,0.523598775598299,0.785398163397448,0,3.31612557878923,0.785398163397448,0,-2.61799387799149,0.785398163397448,0,-2.96705972839036,0.785398163397448,0,0.523598775598299,0.785398163397448,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];

R_Left_Step_Up = [0,-2.61799387799149,0.785398163397448,0,0.174532925199433,1.5707963267949,0,3.66519142918809,0.785398163397448,0,-2.96705972839036,1.5707963267949,0,-2.61799387799149,0.785398163397448,0,0.174532925199433,1.5707963267949,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
R_Left_Turn = [0,-2.61799387799149,0.785398163397448,-0.523598775598299,0.174532925199433,1.5707963267949,0,3.66519142918809,0.785398163397448,-0.349065850398866,-2.96705972839036,1.5707963267949,0,-2.61799387799149,0.785398163397448,-0.349065850398866,0.174532925199433,1.5707963267949,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
R_Left_Step_Down = [0,-2.61799387799149,0.785398163397448,-0.523598775598299,0.174532925199433,0.785398163397448,0,3.66519142918809,0.785398163397448,-0.349065850398866,-2.96705972839036,0.785398163397448,0,-2.61799387799149,0.785398163397448,-0.349065850398866,0.174532925199433,0.785398163397448,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
R_Left_Foot_Down = [0,-2.61799387799149,0.785398163397448,-0.523598775598299,0.523598775598299,0.785398163397448,0,3.66519142918809,0.785398163397448,-0.349065850398866,-2.61799387799149,0.785398163397448,0,-2.61799387799149,0.785398163397448,-0.349065850398866,0.523598775598299,0.785398163397448,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
R_Right_Step_Up = [0,-2.96705972839036,1.5707963267949,-0.523598775598299,0.523598775598299,0.785398163397448,0,3.31612557878923,1.5707963267949,-0.349065850398866,-2.61799387799149,0.785398163397448,0,-2.96705972839036,1.5707963267949,-0.349065850398866,0.523598775598299,0.785398163397448,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
R_Left_Unturn = [0,-2.96705972839036,1.5707963267949,0,0.523598775598299,0.785398163397448,0,3.31612557878923,1.5707963267949,0,-2.61799387799149,0.785398163397448,0,-2.96705972839036,1.5707963267949,0,0.523598775598299,0.785398163397448,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
R_Right_Turn = [-0.349065850398866,-2.96705972839036,1.5707963267949,0,0.523598775598299,0.785398163397448,-0.349065850398866,3.31612557878923,1.5707963267949,0,-2.61799387799149,0.785398163397448,-0.523598775598299,-2.96705972839036,1.5707963267949,0,0.523598775598299,0.785398163397448,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
R_Right_Step_Down = [-0.349065850398866,-2.96705972839036,0.785398163397448,0,0.523598775598299,0.785398163397448,-0.349065850398866,3.31612557878923,0.785398163397448,0,-2.61799387799149,0.785398163397448,-0.523598775598299,-2.96705972839036,0.785398163397448,0,0.523598775598299,0.785398163397448,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
R_Right_Foot_Down = [-0.349065850398866,-2.61799387799149,0.785398163397448,0,0.523598775598299,0.785398163397448,-0.349065850398866,3.66519142918809,0.785398163397448,0,-2.61799387799149,0.785398163397448,-0.523598775598299,-2.61799387799149,0.785398163397448,0,0.523598775598299,0.785398163397448,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
R_Left_Step_Up_2 = [-0.349065850398866,-2.61799387799149,0.785398163397448,0,0.174532925199433,1.5707963267949,-0.349065850398866,3.66519142918809,0.785398163397448,0,-2.96705972839036,1.5707963267949,-0.523598775598299,-2.61799387799149,0.785398163397448,0,0.174532925199433,1.5707963267949,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
R_Right_Unturn = [0,-2.61799387799149,0.785398163397448,0,0.174532925199433,1.5707963267949,0,3.66519142918809,0.785398163397448,0,-2.96705972839036,1.5707963267949,0,-2.61799387799149,0.785398163397448,0,0.174532925199433,1.5707963267949,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
R_Left_Foot_Down_2 = [0,-2.61799387799149,0.785398163397448,0,0.174532925199433,0.785398163397448,0,3.66519142918809,0.785398163397448,0,-2.96705972839036,0.785398163397448,0,-2.61799387799149,0.785398163397448,0,0.174532925199433,0.785398163397448,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];

Front_Right_Up = [0,-4.01425727958696,0.785398163397448,0,0.523598775598299,0.785398163397448,0,3.66519142918809,0.785398163397448,0,-2.61799387799149,0.785398163397448,0,-2.61799387799149,0.785398163397448,0,0.523598775598299,0.785398163397448,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
Front_Right_Forward = [0.785398163397448,-4.01425727958696,0.785398163397448,0,0.523598775598299,0.785398163397448,0,3.66519142918809,0.785398163397448,0,-2.61799387799149,0.785398163397448,0,-2.61799387799149,0.785398163397448,0,0.523598775598299,0.785398163397448,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
Front_Right_Rest = [0.785398163397448,-3.31612557878923,0.785398163397448,0,0.523598775598299,0.785398163397448,0,3.66519142918809,0.785398163397448,0,-2.61799387799149,0.785398163397448,0,-2.61799387799149,0.785398163397448,0,0.523598775598299,0.785398163397448,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
Front_Left_Up = [0.785398163397448,-3.31612557878923,0.785398163397448,0,0.523598775598299,0.785398163397448,0,3.66519142918809,0.785398163397448,0,-4.01425727958696,0.785398163397448,0,-2.61799387799149,0.785398163397448,0,0.523598775598299,0.785398163397448,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
Front_Left_Forward = [0.785398163397448,-3.31612557878923,0.785398163397448,0,0.523598775598299,0.785398163397448,0,3.66519142918809,0.785398163397448,-0.785398163397448,-4.01425727958696,0.785398163397448,0,-2.61799387799149,0.785398163397448,0,0.523598775598299,0.785398163397448,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966 ];
Front_Left_Rest = [0.785398163397448,-3.31612557878923,0.785398163397448,0,0.523598775598299,0.785398163397448,0,3.66519142918809,0.785398163397448,-0.785398163397448,-3.31612557878923,0.785398163397448,0,-2.61799387799149,0.785398163397448,0,0.523598775598299,0.785398163397448,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966 ];

Back_Right_Up = [0.785398163397448,-3.31612557878923,0.785398163397448,0,0.174532925199433,0.785398163397448,0,3.66519142918809,0.785398163397448,-0.785398163397448,-3.31612557878923,0.785398163397448,0,-2.61799387799149,0.785398163397448,0,0.174532925199433,0.785398163397448,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
Back_Right_Twist = [0.785398163397448,-3.31612557878923,0.785398163397448,0.523598775598299,0.174532925199433,0.785398163397448,0,3.66519142918809,0.785398163397448,-0.785398163397448,-3.31612557878923,0.785398163397448,0,-2.61799387799149,0.785398163397448,-0.349065850398866,0.174532925199433,0.785398163397448,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
Back_Right_Down = [0.785398163397448,-3.31612557878923,0.785398163397448,0.523598775598299,0.523598775598299,0.785398163397448,0,3.66519142918809,0.785398163397448,-0.785398163397448,-3.31612557878923,0.785398163397448,0,-2.61799387799149,0.785398163397448,-0.349065850398866,0.523598775598299,0.785398163397448,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
Back_Left_Up = [0.785398163397448,-3.31612557878923,0.785398163397448,0.523598775598299,0.523598775598299,0.785398163397448,0,3.31612557878923,0.785398163397448,-0.785398163397448,-3.31612557878923,0.785398163397448,0,-2.96705972839036,0.785398163397448,-0.349065850398866,0.523598775598299,0.785398163397448,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
Left_Twist_Right_Untwist = [0.785398163397448,-3.31612557878923,0.785398163397448,0,0.523598775598299,0.785398163397448,0.349065850398866,3.31612557878923,0.785398163397448,-0.785398163397448,-3.31612557878923,0.785398163397448,-0.523598775598299,-2.96705972839036,0.785398163397448,0,0.523598775598299,0.785398163397448,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
Back_Left_Down = [0.785398163397448,-3.31612557878923,0.785398163397448,0,0.523598775598299,0.785398163397448,0.349065850398866,3.66519142918809,0.785398163397448,-0.785398163397448,-3.31612557878923,0.785398163397448,-0.523598775598299,-2.61799387799149,0.785398163397448,0,0.523598775598299,0.785398163397448,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
Back_Right_Up2 = [0.785398163397448,-3.31612557878923,0.785398163397448,0,0.174532925199433,0.785398163397448,0.349065850398866,3.66519142918809,0.785398163397448,-0.785398163397448,-3.31612557878923,0.785398163397448,-0.523598775598299,-2.61799387799149,0.785398163397448,0,0.174532925199433,0.785398163397448,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
Back_Left_Untwist = [0.785398163397448,-3.31612557878923,0.785398163397448,0,0.174532925199433,0.785398163397448,0,3.66519142918809,0.785398163397448,-0.785398163397448,-3.31612557878923,0.785398163397448,0,-2.61799387799149,0.785398163397448,0,0.174532925199433,0.785398163397448,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
Back_Right_Down2 = [0.785398163397448,-3.31612557878923,0.785398163397448,0,0.523598775598299,0.785398163397448,0,3.66519142918809,0.785398163397448,-0.785398163397448,-3.31612557878923,0.785398163397448,0,-2.61799387799149,0.785398163397448,0,0.523598775598299,0.785398163397448,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];

Middle_Legs_Up =[0.785398163397448,-2.61799387799149,0.785398163397448,0,-0.872664625997165,0.785398163397448,0,3.66519142918809,0.785398163397448,-0.785398163397448,-2.61799387799149,0.785398163397448,0,-4.01425727958696,0.785398163397448,0,0.523598775598299,0.785398163397448,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
Middle_Legs_Forward = [0.785398163397448,-2.61799387799149,0.785398163397448,0.523598775598299,-0.872664625997165,0.785398163397448,0,3.66519142918809,0.785398163397448,-0.785398163397448,-2.61799387799149,0.785398163397448,-0.523598775598299,-4.01425727958696,0.785398163397448,0,0.523598775598299,0.785398163397448,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966]; 
Middle_Legs_Rest = [0.785398163397448,-2.61799387799149,0.785398163397448,0.523598775598299,0.523598775598299,0.785398163397448,0,3.66519142918809,0.785398163397448,-0.785398163397448,-2.61799387799149,0.785398163397448,-0.523598775598299,-2.61799387799149,0.785398163397448,0,0.523598775598299,0.785398163397448,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966]; 
Middle_Legs_Back = [0.785398163397448,-2.61799387799149,0.785398163397448,0,0.523598775598299,0.785398163397448,0,3.66519142918809,0.785398163397448,-0.785398163397448,-2.61799387799149,0.785398163397448,0,-2.61799387799149,0.785398163397448,0,0.523598775598299,0.785398163397448,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
Back_Legs_Back = [0.785398163397448,-2.61799387799149,0.785398163397448,0,0.523598775598299,0.785398163397448,-0.698131700797732,3.66519142918809,0.785398163397448,-0.785398163397448,-2.61799387799149,0.785398163397448,0,-2.61799387799149,0.785398163397448,0.698131700797732,0.523598775598299,0.785398163397448,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
Back_Legs_Upright = [0.785398163397448,-2.61799387799149,0.785398163397448,0,0.523598775598299,0.785398163397448,-0.698131700797732,4.88692190558412,0,-0.785398163397448,-2.61799387799149,0.785398163397448,0,-2.61799387799149,0.785398163397448,0.698131700797732,1.5707963267949,0,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];

Front_Legs = [0,-2.61799387799149,0.785398163397448,0,0.523598775598299,0.785398163397448,-0.698131700797732,4.88692190558412,0,0,-2.61799387799149,0.785398163397448,0,-2.61799387799149,0.785398163397448,0.698131700797732,1.5707963267949,0,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];

Front_Legs_Straight = [0,-2.96705972839036,0.785398163397448,0,0.523598775598299,0.785398163397448,-0.698131700797732,4.88692190558412,0,0,-2.61799387799149,0.785398163397448,0,-2.96705972839036,0.785398163397448,0.698131700797732,1.5707963267949,0,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
Back_Right_Up3 = [0.349065850398866,-2.96705972839036,0.785398163397448,0,0.523598775598299,0.785398163397448,-0.698131700797732,4.88692190558412,0,0,-2.61799387799149,0.785398163397448,-0.349065850398866,-2.96705972839036,0.785398163397448,0.698131700797732,1.5707963267949,0,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
Back_Right_Forward3 = [0.349065850398866,-2.61799387799149,0.785398163397448,0,0.523598775598299,0.785398163397448,-0.698131700797732,4.88692190558412,0,0,-2.61799387799149,0.785398163397448,-0.349065850398866,-2.61799387799149,0.785398163397448,0.698131700797732,1.5707963267949,0,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
Back_Right_Down3 = [0.349065850398866,-2.61799387799149,0.785398163397448,0,0.174532925199433,0.785398163397448,-0.698131700797732,4.88692190558412,0,0,-2.96705972839036,0.785398163397448,-0.349065850398866,-2.61799387799149,0.785398163397448,0.698131700797732,1.5707963267949,0,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
Back_Left_Up3 = [0,-2.61799387799149,0.785398163397448,0.523598775598299,0.174532925199433,0.785398163397448,-0.698131700797732,4.88692190558412,0,-0.349065850398866,-2.96705972839036,0.785398163397448,0,-2.61799387799149,0.785398163397448,0.698131700797732,1.5707963267949,0,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
Back_Left_Forward3 = [0,-2.61799387799149,0.785398163397448,0.523598775598299,0.523598775598299,0.785398163397448,-0.698131700797732,4.88692190558412,0,-0.349065850398866,-2.61799387799149,0.785398163397448,0,-2.61799387799149,0.785398163397448,0.698131700797732,1.5707963267949,0,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
Back_Left_Down3 = [0,-2.96705972839036,0.785398163397448,0.523598775598299,0.523598775598299,0.785398163397448,-0.698131700797732,4.88692190558412,0,-0.349065850398866,-2.61799387799149,0.785398163397448,0,-2.96705972839036,0.785398163397448,0.698131700797732,1.5707963267949,0,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
Front_Right_Up2 =[0,-2.96705972839036,0.785398163397448,0,0.523598775598299,0.785398163397448,-0.698131700797732,4.88692190558412,0,0,-2.61799387799149,0.785398163397448,0,-2.96705972839036,0.785398163397448,0.698131700797732,1.5707963267949,0,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
Front_Right_forward2 =[0,-2.61799387799149,0.785398163397448,0,0.523598775598299,0.785398163397448,-0.698131700797732,4.88692190558412,0,0,-2.61799387799149,0.785398163397448,0,-2.61799387799149,0.785398163397448,0.698131700797732,1.5707963267949,0,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];


Front_Right_Down2 =[0,-2.61799387799149,0.785398163397448,0,0.523598775598299,0.785398163397448,-0.698131700797732,2.26892802759263,0.785398163397448,0,-2.61799387799149,0.785398163397448,0,-2.61799387799149,0.785398163397448,0.698131700797732,1.5707963267949,0,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
Front_Left_Up2 =[0,-2.61799387799149,0.785398163397448,0,0.523598775598299,0.785398163397448,0.785398163397448,2.26892802759263,0.785398163397448,0,-2.61799387799149,0.785398163397448,0,-2.61799387799149,0.785398163397448,0.698131700797732,1.5707963267949,0,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
Front_Left_Forward2 =[0,-2.61799387799149,0.785398163397448,0,0.523598775598299,0.785398163397448,0.785398163397448,3.66519142918809,0.785398163397448,0,-2.61799387799149,0.785398163397448,0,-2.61799387799149,0.785398163397448,0.698131700797732,1.5707963267949,0,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
Front_Left_Down2 =[0,-2.61799387799149,0.785398163397448,0,0.523598775598299,0.785398163397448,0.785398163397448,3.66519142918809,0.785398163397448,0,-2.61799387799149,0.785398163397448,0,-2.61799387799149,0.785398163397448,0.698131700797732,-0.872664625997165,0.785398163397448,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
Front_Right_Up3 =[0,-2.61799387799149,0.785398163397448,0,0.523598775598299,0.785398163397448,0.785398163397448,3.66519142918809,0.785398163397448,0,-2.61799387799149,0.785398163397448,0,-2.61799387799149,0.785398163397448,-0.785398163397448,-0.872664625997165,0.785398163397448,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
Front_Left_Straight2 =[0,-2.61799387799149,0.785398163397448,0,0.523598775598299,0.785398163397448,0.785398163397448,3.66519142918809,0.785398163397448,0,-2.61799387799149,0.785398163397448,0,-2.61799387799149,0.785398163397448,-0.785398163397448,0.523598775598299,0.785398163397448,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];

Right_Up = [0,-2.96705972839036,0.785398163397448,0,0.523598775598299,0.785398163397448,0.785398163397448,3.66519142918809,0.785398163397448,0,-2.61799387799149,0.785398163397448,0,-2.96705972839036,0.785398163397448,-0.785398163397448,0.523598775598299,0.785398163397448,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
Right_Forward = [0.349065850398866,-2.96705972839036,0.785398163397448,0,0.523598775598299,0.785398163397448,0.785398163397448,3.66519142918809,0.785398163397448,0,-2.61799387799149,0.785398163397448,-0.523598775598299,-2.96705972839036,0.785398163397448,-0.785398163397448,0.523598775598299,0.785398163397448,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
Right_Down = [0.349065850398866,-2.61799387799149,0.785398163397448,0,0.523598775598299,0.785398163397448,0.785398163397448,3.66519142918809,0.785398163397448,0,-2.61799387799149,0.785398163397448,-0.523598775598299,-2.61799387799149,0.785398163397448,-0.785398163397448,0.523598775598299,0.785398163397448,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
Left_Up = [0.349065850398866,-2.61799387799149,0.785398163397448,0,0.174532925199433,0.785398163397448,0.785398163397448,3.66519142918809,0.785398163397448,0,-2.96705972839036,0.785398163397448,-0.523598775598299,-2.61799387799149,0.785398163397448,-0.785398163397448,0.174532925199433,0.785398163397448,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
Left_Twist = [0,-2.61799387799149,0.785398163397448,0.523598775598299,0.174532925199433,0.785398163397448,0,3.66519142918809,0.785398163397448,-0.349065850398866,-2.96705972839036,0.785398163397448,0,-2.61799387799149,0.785398163397448,-0.785398163397448,0.174532925199433,0.785398163397448,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
Left_Down = [0,-2.61799387799149,0.785398163397448,0.523598775598299,0.523598775598299,0.785398163397448,0,3.66519142918809,0.785398163397448,-0.349065850398866,-2.61799387799149,0.785398163397448,0,-2.61799387799149,0.785398163397448,-0.785398163397448,0.523598775598299,0.785398163397448,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
Right_Up2 = [0,-2.96705972839036,0.785398163397448,0.523598775598299,0.523598775598299,0.785398163397448,0,3.31612557878923,0.785398163397448,-0.349065850398866,-2.61799387799149,0.785398163397448,0,-2.96705972839036,0.785398163397448,-0.785398163397448,0.523598775598299,0.785398163397448,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
Left_Untwist = [0,-2.96705972839036,0.785398163397448,0,0.523598775598299,0.785398163397448,0,3.31612557878923,0.785398163397448,0,-2.61799387799149,0.785398163397448,0,-2.96705972839036,0.785398163397448,0,0.523598775598299,0.785398163397448,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966];
Right_Down2 = [0,-2.61799387799149,0.785398163397448,0,0.523598775598299,0.785398163397448,0,3.66519142918809,0.785398163397448,0,-2.61799387799149,0.785398163397448,0,-2.61799387799149,0.785398163397448,0,0.523598775598299,0.785398163397448,0,-0.785398163397448,-0.785398163397448,-0.785398163397448,-1.0471975511966]; 



h= [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];

[r,h(1)] = sim.simxGetObjectHandle(clientID,'Front_Right_Joint',sim.simx_opmode_blocking);
[r,h(2)] = sim.simxGetObjectHandle(clientID,'Front_Right_Limb',sim.simx_opmode_blocking);
[r,h(3)] = sim.simxGetObjectHandle(clientID,'Front_Right_Foot',sim.simx_opmode_blocking);
[r,h(4)]= sim.simxGetObjectHandle(clientID,'Mid_Right_Joint',sim.simx_opmode_blocking);
[r,h(5)] = sim.simxGetObjectHandle(clientID,'Mid_Right_Limb',sim.simx_opmode_blocking);
[r,h(6)] = sim.simxGetObjectHandle(clientID,'Mid_Right_Foot',sim.simx_opmode_blocking);
[r,h(7)] = sim.simxGetObjectHandle(clientID,'Back_Right_Joint',sim.simx_opmode_blocking);
[r,h(8)] = sim.simxGetObjectHandle(clientID,'Back_Right_Limb',sim.simx_opmode_blocking);
[r,h(9)] = sim.simxGetObjectHandle(clientID,'Back_Right_Foot',sim.simx_opmode_blocking);
[r,h(10)] = sim.simxGetObjectHandle(clientID,'Front_Left_Joint',sim.simx_opmode_blocking);
[r,h(11)] = sim.simxGetObjectHandle(clientID,'Front_Left_Limb',sim.simx_opmode_blocking);
[r,h(12)] = sim.simxGetObjectHandle(clientID,'Front_Left_Foot',sim.simx_opmode_blocking);
[r,h(13)] = sim.simxGetObjectHandle(clientID,'Mid_Left_Joint',sim.simx_opmode_blocking);
[r,h(14)] = sim.simxGetObjectHandle(clientID,'Mid_Left_Limb',sim.simx_opmode_blocking);
[r,h(15)] = sim.simxGetObjectHandle(clientID,'Mid_Left_Foot',sim.simx_opmode_blocking);
[r,h(16)] = sim.simxGetObjectHandle(clientID,'Back_Left_Joint',sim.simx_opmode_blocking);
[r,h(17)]= sim.simxGetObjectHandle(clientID,'Back_Left_Limb',sim.simx_opmode_blocking);
[r,h(18)] = sim.simxGetObjectHandle(clientID,'Back_Left_Foot',sim.simx_opmode_blocking);
[r,h(19)] = sim.simxGetObjectHandle(clientID,'Tail_Joint',sim.simx_opmode_blocking);
[r,h(20)] = sim.simxGetObjectHandle(clientID,'Tail_Segment_1',sim.simx_opmode_blocking);
[r,h(21)] = sim.simxGetObjectHandle(clientID,'Tail_Segment_2',sim.simx_opmode_blocking);
[r,h(22)] = sim.simxGetObjectHandle(clientID,'Tail_Segment_3',sim.simx_opmode_blocking);
[r,h(23)] = sim.simxGetObjectHandle(clientID,'Tail_Head',sim.simx_opmode_blocking);
    



    for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Rest_Position(i) ,sim.simx_opmode_streaming);
    end
    pause(0.15);
    
    for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Right_Step_Up(i) ,sim.simx_opmode_streaming);
    end
    pause(0.15);
    
   detected_points = [0,0,5];
   detected_points_cl = [0,0,5]
    
    while detected_points(3)>0; 
    
    for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Right_Twisted(i) ,sim.simx_opmode_streaming);
    end
    pause(0.15);
    
    for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Right_Step_Down(i) ,sim.simx_opmode_streaming);
    end
    pause(0.15);
    
    for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Right_Foot_Down(i) ,sim.simx_opmode_streaming);
    end
    pause(0.15);
    
    for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Left_Step_Up(i) ,sim.simx_opmode_streaming);
    end
    pause(0.15);
    
    for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Right_Untwisted(i) ,sim.simx_opmode_streaming);
    end
    pause(0.15);
    
    for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Left_Twisted(i) ,sim.simx_opmode_streaming);
    end
    pause(0.15);
    
    for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Left_Step_Down(i) ,sim.simx_opmode_streaming);
    end
    pause(0.15);
    
    for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Left_Foot_Down(i) ,sim.simx_opmode_streaming);
    end
    pause(0.15);
    
    for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Right_Step_Up_2(i) ,sim.simx_opmode_streaming);
    end
    pause(0.15);
    
    for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Left_Untwisted(i) ,sim.simx_opmode_streaming);
    end
    pause(0.15);
   
 
[r,LIDAR_handle] = sim.simxGetObjectHandle(clientID,'LIDAR',sim.simx_opmode_blocking);    
[return_code,array_handles,array_intData,array_floatData,array_stringData]=sim.simxGetObjectGroupData(clientID,LIDAR_handle,13,sim.simx_opmode_blocking);
[return_code,detection,detected_points,detected_object,detected_array] = sim.simxReadProximitySensor(clientID,LIDAR_handle,sim.simx_opmode_blocking);
   

[r,Climb_LIDAR_handle] = sim.simxGetObjectHandle(clientID,'Climb_LIDAR',sim.simx_opmode_blocking);    
[return_code,array_handles,array_intData,array_floatData,array_stringData]=sim.simxGetObjectGroupData(clientID,Climb_LIDAR_handle,13,sim.simx_opmode_blocking);
[return_code,detection_cl,detected_points_cl,detected_object,detected_array_cl] = sim.simxReadProximitySensor(clientID,Climb_LIDAR_handle,sim.simx_opmode_blocking);


 
if detected_points_cl(3) < 0.5 && detected_points(3) > 0.7
    
 for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Right_Foot_Down_2(i) ,sim.simx_opmode_streaming);
    end
    pause(0.15);
    
    for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Rest_Position(i) ,sim.simx_opmode_streaming);
    end
    pause(0.15); 

  for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Front_Right_Up(i) ,sim.simx_opmode_streaming);
    end
    pause(0.5);
    
    for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Front_Right_Forward(i) ,sim.simx_opmode_streaming);
    end
    pause(0.5);
    
    for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Front_Right_Rest(i) ,sim.simx_opmode_streaming);
    end
    pause(0.5);
    
    for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Front_Left_Up(i) ,sim.simx_opmode_streaming);
    end
    pause(0.5);
    
    for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Front_Left_Forward(i) ,sim.simx_opmode_streaming);
    end
    pause(0.5);
 
  for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Front_Left_Rest(i) ,sim.simx_opmode_streaming);
    end
    pause(0.5);
    
    n=1 
    for n = 1:2 
    
    for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Back_Right_Up(i) ,sim.simx_opmode_streaming);
    end
    pause(0.5);
    
        for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Back_Right_Twist(i) ,sim.simx_opmode_streaming);
    end
    pause(0.5);
    
          for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Back_Right_Down(i) ,sim.simx_opmode_streaming);
    end
    pause(0.5);

           for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Back_Left_Up(i) ,sim.simx_opmode_streaming);
    end
    pause(0.5);

    
           for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Left_Twist_Right_Untwist(i) ,sim.simx_opmode_streaming);
    end
    pause(0.5);
    
           for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Back_Left_Down(i) ,sim.simx_opmode_streaming);
    end
    pause(0.5);
    
           for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Back_Right_Up2(i) ,sim.simx_opmode_streaming);
    end
    pause(0.5);
    
           for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Back_Left_Untwist(i) ,sim.simx_opmode_streaming);
    end
    pause(0.5);
    
           for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Back_Right_Down2(i) ,sim.simx_opmode_streaming);
    end
    pause(0.5);

    
    n = 2 
    
    end 
    
            for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Middle_Legs_Up(i) ,sim.simx_opmode_streaming);
    end
    pause(1);
 
         for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Middle_Legs_Forward(i) ,sim.simx_opmode_streaming);
    end
    pause(1);
           
    for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Middle_Legs_Rest(i) ,sim.simx_opmode_streaming);
    end
    pause(1);
 
            
    for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Middle_Legs_Back(i) ,sim.simx_opmode_streaming);
    end
    pause(1);
    
           
    for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Back_Legs_Back(i) ,sim.simx_opmode_streaming);
    end
    pause(1);
    
     for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Back_Legs_Upright(i) ,sim.simx_opmode_streaming);
    end
    pause(1);

    
     for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Front_Legs(i) ,sim.simx_opmode_streaming);
    end
    pause(1);
    
    
     for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Front_Legs_Straight(i) ,sim.simx_opmode_streaming);
    end
    pause(1);
    
    
    %
     for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Back_Right_Up3(i) ,sim.simx_opmode_streaming);
    end
    pause(1);
    
     for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Back_Right_Forward3(i) ,sim.simx_opmode_streaming);
    end
    pause(1);
    
     for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Back_Right_Down3(i) ,sim.simx_opmode_streaming);
    end
    pause(1);
    
     for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Back_Left_Up3(i) ,sim.simx_opmode_streaming);
    end
    pause(1);
    
     for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Back_Left_Forward3(i) ,sim.simx_opmode_streaming);
    end
    pause(1);
    
     for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Back_Left_Down3(i) ,sim.simx_opmode_streaming);
    end
    pause(1);

    for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Front_Right_Up2(i) ,sim.simx_opmode_streaming);
    end
    pause(1);
    
       for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Front_Right_forward2(i) ,sim.simx_opmode_streaming);
    end
    pause(1);
   
      
    for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Front_Right_Down2(i) ,sim.simx_opmode_streaming);
    end
    pause(1);
   
        for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Front_Left_Up2(i) ,sim.simx_opmode_streaming);
    end
    pause(1);
    
       for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Front_Left_Forward2(i) ,sim.simx_opmode_streaming);
    end
    pause(1);
      
    for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Front_Left_Down2(i) ,sim.simx_opmode_streaming);
    end
    pause(1);
    
       for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Front_Right_Up3(i) ,sim.simx_opmode_streaming);
    end
    pause(1);
    
       for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Front_Left_Straight2(i) ,sim.simx_opmode_streaming);
    end
    pause(1);
      
   
    %
    

     for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Right_Up(i) ,sim.simx_opmode_streaming);
    end
    pause(1);
    
          for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Right_Forward(i) ,sim.simx_opmode_streaming);
    end
    pause(1);
    
          for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Right_Down(i) ,sim.simx_opmode_streaming);
    end
    pause(1);
    
     for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Left_Up(i) ,sim.simx_opmode_streaming);
    end
    pause(1);
    
          for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Left_Twist(i) ,sim.simx_opmode_streaming);
    end
    pause(1);
    
          for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Left_Down(i) ,sim.simx_opmode_streaming);
    end
    pause(1);
    
     for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Right_Up2(i) ,sim.simx_opmode_streaming);
    end
    pause(1);
    
          for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Left_Untwist(i) ,sim.simx_opmode_streaming);
    end
    pause(1);
    
          for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Right_Down2(i) ,sim.simx_opmode_streaming);
    end
    pause(1);

    
    

end
   
   if detected_points(3)<1.5;
    
    for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Right_Foot_Down_2(i) ,sim.simx_opmode_streaming);
    end
    pause(0.15);
    
    for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Rest_Position(i) ,sim.simx_opmode_streaming);
    end
    pause(0.15); 
    
     for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Tail_Leftt(i) ,sim.simx_opmode_streaming);
    end
    pause(1);
    
    [r,LIDAR_handle] = sim.simxGetObjectHandle(clientID,'LIDAR',sim.simx_opmode_blocking);    
[return_code,array_handles,array_intData,array_floatData,array_stringData]=sim.simxGetObjectGroupData(clientID,LIDAR_handle,13,sim.simx_opmode_blocking);
[return_code,detection,detected_points_L,detected_object,detected_array] = sim.simxReadProximitySensor(clientID,LIDAR_handle,sim.simx_opmode_blocking);
   
    for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Tail_Rightt(i) ,sim.simx_opmode_streaming);
    end
    pause(1);
    
       [r,LIDAR_handle] = sim.simxGetObjectHandle(clientID,'LIDAR',sim.simx_opmode_blocking);    
[return_code,array_handles,array_intData,array_floatData,array_stringData]=sim.simxGetObjectGroupData(clientID,LIDAR_handle,13,sim.simx_opmode_blocking);
[return_code,detection,detected_points_R,detected_object,detected_array] = sim.simxReadProximitySensor(clientID,LIDAR_handle,sim.simx_opmode_blocking);
   
  for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Rest_Position(i) ,sim.simx_opmode_streaming);
    end
    pause(1);
    
    
[r,LIDAR_handle] = sim.simxGetObjectHandle(clientID,'LIDAR',sim.simx_opmode_blocking);    
[return_code,array_handles,array_intData,array_floatData,array_stringData]=sim.simxGetObjectGroupData(clientID,LIDAR_handle,13,sim.simx_opmode_blocking);
[return_code,detection,detected_points,detected_object,detected_array] = sim.simxReadProximitySensor(clientID,LIDAR_handle,sim.simx_opmode_blocking);
   




    if detected_points_L(3) > detected_points_R(3)
     for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Right_Step_Up(i) ,sim.simx_opmode_streaming);
    end
    pause(0.15);
    
    clearance_space = detected_points(3) + 0.2; 
    
    L_Count = 1
    
    while detected_points(3) < clearance_space && L_Count < 10
    
    for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),L_Right_Turn(i) ,sim.simx_opmode_streaming);
    end
    pause(0.15);
    
    for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),L_Right_Step_Down(i) ,sim.simx_opmode_streaming);
    end
    pause(0.15);
    
    for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),L_Right_Foot_Down(i) ,sim.simx_opmode_streaming);
    end
    pause(0.15);
    
    for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),L_Left_Step_Up(i) ,sim.simx_opmode_streaming);
    end
    pause(0.15);
    
    for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),L_Right_Unturn(i) ,sim.simx_opmode_streaming);
    end
    pause(0.15);
    
    for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),L_Left_Turn(i) ,sim.simx_opmode_streaming);
    end
    pause(0.15);
    
    for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),L_Left_Step_Down(i) ,sim.simx_opmode_streaming);
    end
    pause(0.15);
    
    for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),L_Left_Foot_Down(i) ,sim.simx_opmode_streaming);
    end
    pause(0.15);
    
    for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),L_Right_Step_Up_2(i) ,sim.simx_opmode_streaming);
    end
    pause(0.15);
    
    for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),L_Left_Unturn(i) ,sim.simx_opmode_streaming);
    end
    pause(0.15);
   
    L_Count = L_Count + 1 
     [r,LIDAR_handle] = sim.simxGetObjectHandle(clientID,'LIDAR',sim.simx_opmode_blocking);    
[return_code,array_handles,array_intData,array_floatData,array_stringData]=sim.simxGetObjectGroupData(clientID,LIDAR_handle,13,sim.simx_opmode_blocking);
[return_code,detection,detected_points,detected_object,detected_array] = sim.simxReadProximitySensor(clientID,LIDAR_handle,sim.simx_opmode_blocking);
   
    
    end
    
    for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),L_Right_Foot_Down_2(i) ,sim.simx_opmode_streaming);
    end
    pause(0.15);
    
    for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Rest_Position(i) ,sim.simx_opmode_streaming);
    end
    pause(0.15);
    end
    
    
    if detected_points_L(3) < detected_points_R(3)
   
        for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),R_Left_Step_Up(i) ,sim.simx_opmode_streaming);
    end
    pause(0.15);
    
        clearance_space = detected_points(3) + 0.2; 
    
        R_Count = 1 
    while detected_points(3) < clearance_space && R_Count < 10
   
    
    for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),R_Left_Turn(i) ,sim.simx_opmode_streaming);
    end
    pause(0.15);
    
    for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),R_Left_Step_Down(i) ,sim.simx_opmode_streaming);
    end
    pause(0.15);
    
    for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),R_Left_Foot_Down(i) ,sim.simx_opmode_streaming);
    end
    pause(0.15);
    
    for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),R_Right_Step_Up(i) ,sim.simx_opmode_streaming);
    end
    pause(0.15);
    
    for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),R_Left_Unturn(i) ,sim.simx_opmode_streaming);
    end
    pause(0.15);
    
    for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),R_Right_Turn(i) ,sim.simx_opmode_streaming);
    end
    pause(0.15);
    
    for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),R_Right_Step_Down(i) ,sim.simx_opmode_streaming);
    end
    pause(0.15);
    
    for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),R_Right_Foot_Down(i) ,sim.simx_opmode_streaming);
    end
    pause(0.15);
    
    for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),R_Left_Step_Up_2(i) ,sim.simx_opmode_streaming);
    end
    pause(0.15);
    
    for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),R_Right_Unturn(i) ,sim.simx_opmode_streaming);
    end
    pause(0.15);
   
       [r,LIDAR_handle] = sim.simxGetObjectHandle(clientID,'LIDAR',sim.simx_opmode_blocking);    
[return_code,array_handles,array_intData,array_floatData,array_stringData]=sim.simxGetObjectGroupData(clientID,LIDAR_handle,13,sim.simx_opmode_blocking);
[return_code,detection,detected_points,detected_object,detected_array] = sim.simxReadProximitySensor(clientID,LIDAR_handle,sim.simx_opmode_blocking);
   
R_Count = R_Count + 1
    
    end
    
    for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),R_Left_Foot_Down_2(i) ,sim.simx_opmode_streaming);
    end
    pause(0.15);
    
    for i=1:23
    sim.simxSetJointTargetPosition(clientID,h(i),Rest_Position(i) ,sim.simx_opmode_streaming);
    end
    pause(0.15);
    end
    
    
   end
    end
    
    
    
   else
    disp('Failed connecting to remote API server');
    
end

sim.delete(); % call the destructor!
    
    
disp('Program ended');
    